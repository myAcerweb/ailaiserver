var app=angular.module("myApp",["ionic"]);app.config(function(b,a){b.state("home",{url:"/myHome",templateUrl:"tpl/home.html",controller:"homeCtrl"}).state("book",{url:"/myBook",templateUrl:"tpl/book.html",controller:"bookCtrl"}).state("user1",{url:"/myUser1",templateUrl:"tpl/user1.html",controller:"user1Ctrl"}).state("register",{url:"/myRegister",templateUrl:"tpl/register.html",controller:"registerCtrl"}).state("reset",{url:"/myReset",templateUrl:"tpl/reset.html",controller:"resetCtrl"}).state("notice",{url:"/myNotice",templateUrl:"tpl/notice.html",controller:"noticeCtrl"}).state("bookingseat",{url:"/mybookingseat",templateUrl:"tpl/bookingseat.html",controller:"bookingseatCtrl"}).state("notice2",{url:"/myNotice2",templateUrl:"tpl/notice2.html",controller:"notice2Ctrl"}).state("checkmsg",{url:"/mybookingseat",templateUrl:"tpl/checkmsg.html",controller:"checkmsgCtrl"}).state("book2",{url:"/mybook2",templateUrl:"tpl/book2.html",controller:"book2Ctrl"}).state("person",{url:"/myperson",templateUrl:"tpl/person.html",controller:"personCtrl"}).state("liveplayer",{url:"/myLivePlayer",templateUrl:"tpl/liveplayer.html",controller:"liveplayerCtrl"});a.otherwise("myHome")});app.controller("parentCtrl",["$scope","$ionicSlideBoxDelegate","$state","$timeout",function(a,d,c,b){a.slideStart=function(e){c.go("start");b(function(){d.slide(e)},10)}}]);app.controller("homeCtrl",["$scope","$ionicSlideBoxDelegate","$state",function(a,c,b){a.slideTo=function(d){c.slide(d)};a.love=function(){if(!localStorage.phone){alert("è¯·å…ˆç™»å½•");b.go("user1");return}window.location.href="http://m.ailaiwenhua.com/index.jsp"};a.scene=function(){if(!localStorage.phone){alert("è¯·å…ˆç™»å½•");b.go("user1");return}b.go("liveplayer")};a.scene1=function(){if(!localStorage.phone){alert("è¯·å…ˆç™»å½•");b.go("user1");return}b.go("liveplayer")};a.book=function(){if(!localStorage.phone){alert("è¯·å…ˆç™»å½•");b.go("user1");return}b.go("book")};a.notice=function(){console.log(localStorage.phone);if(!localStorage.phone){alert("è¯·å…ˆç™»å½•");b.go("user1");return}b.go("notice")}}]);app.controller("bookCtrl",["$scope","$http","$state",function(a,c,b){a.user=localStorage.phone;c.get("http://139.224.33.228:88/read?id="+a.user).success(function(d){a.data=d;if(d.name=="null"){d.name=""}if(d.gender==1){d.gender="ç”?"}else{d.gender="å¥?"}console.log(d)}).error(function(){console.log("è¯»å–å¤±è´¥")});a.check=function(){c.get("http://139.224.33.228:88/query?id="+a.user).success(function(d){console.log(d);a.list=d;if(a.list.message=="æ— é¢†ç¥¨è®°å½?"){alert("æ‚¨è¿˜æœªé¢†ç¥¨å“¦~")}}).error(function(){console.log("å¼‚æ­¥è¯·æ±‚å¤±è´¥")})};a.quit=function(){localStorage.phone="";b.go("home")}}]);app.controller("user1Ctrl",["$scope","$http","$state","$rootScope",function(b,d,c,a){b.agree=true;b.phone="";b.password="";b.login=function(){if(localStorage.phone){alert("æ‚¨å·²ç™»å½•");c.go("home");return}if(b.agree!==true){alert("è¯·åŒæ„åè®?");return}d.get("http://139.224.33.228:88/login?account="+b.phone+"&password="+b.password).success(function(e){console.log(e);if(e.message=="ç™»å½•æˆåŠŸ"){localStorage.phone=b.phone;console.log(localStorage.phone);a.phone=b.phone;alert("æ‚¨å·²ç™»å½•æˆåŠŸ");c.go("home")}else{if(e.message=="å¯†ç ä¸æ­£ç¡?"){alert("å¯†ç ä¸æ­£ç¡?")}else{if(e.message=="è´¦æˆ·ä¸å­˜åœ?"){alert("è¯¥æ‰‹æœºå·æœªæ³¨å†?");return}}}}).error(function(){console.log("è¯·æ±‚é”™è¯¯")})}}]);app.controller("registerCtrl",["$scope","$interval","$timeout","$http","$state","$rootScope",function(b,f,e,g,d,a){b.paracont="è·å–éªŒè¯ç ?";b.paraclass="but_null";b.paraevent="true";var c=60;timePromise=undefined;b.i=1;b.sex1=function(){b.x=document.getElementById("imgx");b.e=document.getElementById("imge");b.s=document.getElementById("imgs");if(b.i==0){imge.src="img/sex_2.png";imgx.src="img/sex_3.png";imgs.src="img/sex_6.png";b.i=1}};b.sex2=function(){b.x=document.getElementById("imgx");b.s=document.getElementById("imgs");b.e=document.getElementById("imge");if(b.i==1){imgx.src="img/sex_4.png";imge.src="img/sex_1.png";imgs.src="img/sex_5.png";b.i=0}};b.phone="";b.gender="";b.password="";b.code="";b.share="";b.agree=true;b.register=function(){a=b.i;console.log(b.i);if(b.agree!==true){alert("è¯·åŒæ„åè®?");return}g.get("http://139.224.33.228:88/regis?&phone="+b.phone+"&gender="+b.i+"&password="+b.password+"&code="+b.code+"&share="+b.share).success(function(h){console.log(h);if(h.message==="æ³¨å†ŒæˆåŠŸ"){alert("æ³¨å†ŒæˆåŠŸ");d.go("user1")}}).error(function(){console.log("æ³¨å†Œå¼‚æ­¥è¯·æ±‚å¤±è´¥")})};b.on=function(){if(b.phone==""){alert("è¯·å¡«å†™æ‰‹æœºå·");return}else{if(b.agree!==true){alert("æ‚¨æœªåŒæ„ç”¨æˆ·åè®®æ— æ³•è·å–éªŒè¯ç ?");return}}if($("#register1").html()=="è·å–éªŒè¯ç ?"||$("#register1").html()=="é‡å‘éªŒè¯ç ?"){g.get("http://139.224.33.228:88/sendsms?&phone="+b.phone).success(function(h){console.log(h);if(h.message=="è¯¥æ‰‹æœºå·å·²æ³¨å†?"){alert("è¯¥æ‰‹æœºå·å·²æ³¨å†?");return}timePromise=f(function(){b.paracont="é‡å‘éªŒè¯ç ?";b.paraclass="but_null";b.paraevent=true;if(c<=0){c=60;f.cancel(timePromise);timePromise=undefined}else{b.paracont=c+"ç§’åå¯é‡å?";b.paraclass="not but_null";c--}},1000)}).error(function(){console.log("çŸ­ä¿¡éªŒè¯è¯·æ±‚å¤±è´¥")})}}}]);app.controller("resetCtrl",["$scope","$interval","$http","$state",function(a,d,e,c){a.paracont="è·å–éªŒè¯ç ?";a.paraclass="but_null";a.paraevent="true";var b=54;timePromise=undefined;a.phone="";a.on=function(){if(a.phone==""){alert("è¯·å¡«å†™æ‰‹æœºå·");return}if($("#register2").html()=="è·å–éªŒè¯ç ?"||$("#register2").html()=="é‡å‘éªŒè¯ç ?"){e.get("http://139.224.33.228:88/backsms?phone="+a.phone).success(function(f){console.log(f)}).error(function(){console.log("è·å–éªŒè¯ç å¤±è´?")});timePromise=d(function(){a.paracont="é‡å‘éªŒè¯ç ?";a.paraclass="but_null";a.paraevent=true;if(b<=-1){b=54;d.cancel(timePromise);timePromise=undefined}else{a.paracont=b+"ç§’åå¯é‡å?";a.paraclass="not but_null";b--}},1000)}};a.password="";a.code="";a.reset=function(){e.get("http://139.224.33.228:88/back?phone="+a.phone+"&password="+a.password+"&code="+a.code).success(function(f){console.log(f);if(f.message==="å¯†ç é‡ç½®æˆåŠŸ"){alert(f.message);localStorage.phone="";c.go("user1")}}).error(function(){console.log("é‡ç½®å¯†ç å¼‚æ­¥è¯·æ±‚å¤±è´¥")})}}]);app.controller("noticeCtrl",["$scope",function(a){}]);app.controller("bookingseatCtrl",["$scope","$http","$state","$rootScope",function(b,d,c,a){d.get("http://139.224.33.228:88/stare?").success(function(f){console.log(f);if(f.message=="è¯»å–æˆåŠŸ"){for(var e=0;e<f.seats.length;e++){$("#"+f.seats[e].cells+"_"+f.seats[e].rows).addClass("seat_changed")}}}).error(function(){console.log("å¼‚æ­¥è¯·æ±‚è®©å·²é€‰åº§ä½å˜è‰²å¤±è´?")});b.now="";b.id="";b.row="";b.cell="";b.clickMe=function(e){$("#seat>div>span").removeClass("seat_change");$("#seat>div>span").removeClass("seat_no");$("#"+e).addClass("seat_change");if($("#"+e).hasClass("seat_changed")){$("#"+e).addClass("seat_no")}b.now=$("#"+e);b.id=b.now.attr("id").split("_");b.row=b.id[1];b.cell=b.id[0]};b.clickUp=function(){$("#seat>div>span").removeClass("seat_no");if(b.now==""){b.now=$("#16_12")}b.now.removeClass("seat_change");b.id=b.now.attr("id").split("_");b.id[1]=parseInt(b.id[1])-1;if(b.id[1]==0){b.id[1]=24;if(b.id[0]==1||b.id[0]==32){b.id[1]=18}else{if(b.id[0]==2||b.id[0]==31){b.id[1]=19}else{if(b.id[0]==3||b.id[0]==4||b.id[0]==5||b.id[0]==28||b.id[0]==29||b.id[0]==30){b.id[1]=22}else{if(b.id[0]==6||b.id[0]==7||b.id[0]==26||b.id[0]==27){b.id[1]=23}}}}}$("#"+b.id[0]+"_"+b.id[1]).addClass("seat_change");b.now=$("#"+b.id[0]+"_"+b.id[1]);b.row=b.id[1];b.cell=b.id[0];if(b.now.hasClass("seat_changed")){b.now.addClass("seat_no")}};b.clickDown=function(){$("#seat>div>span").removeClass("seat_no");if(b.now==""){b.now=$("#16_13")}b.now.removeClass("seat_change");b.id=b.now.attr("id").split("_");b.id[1]=parseInt(b.id[1])+1;if(b.id[1]==19){if(b.id[0]==1||b.id[0]==32){b.id[1]=1}}else{if(b.id[1]==20){if(b.id[0]==2||b.id[0]==31){b.id[1]=1}}else{if(b.id[1]==23){if(b.id[0]==3||b.id[0]==4||b.id[0]==5||b.id[0]==30||b.id[0]==29||b.id[0]==28){b.id[1]=1}}else{if(b.id[1]==24){if(b.id[0]==6||b.id[0]==7||b.id[0]==26||b.id[0]==27){b.id[1]=1}}else{if(b.id[1]==25){b.id[1]=1}}}}}$("#"+b.id[0]+"_"+b.id[1]).addClass("seat_change");b.now=$("#"+b.id[0]+"_"+b.id[1]);b.row=b.id[1];b.cell=b.id[0];if(b.now.hasClass("seat_changed")){b.now.addClass("seat_no")}};b.clickLeft=function(){$("#seat>div>span").removeClass("seat_no");if(b.now==""){b.now=$("#16_13")}b.now.removeClass("seat_change");b.id=b.now.attr("id").split("_");b.id[0]=parseInt(b.id[0])-1;if(b.id[0]==0){b.id[0]=32}if(b.id[0]==2){b.id[1]=parseInt(b.id[1])-2}if(b.id[0]==30){b.id[1]=parseInt(b.id[1])+2}$("#"+b.id[0]+"_"+b.id[1]).addClass("seat_change");b.now=$("#"+b.id[0]+"_"+b.id[1]);b.row=b.id[1];b.cell=b.id[0];if(b.now.hasClass("seat_changed")){b.now.addClass("seat_no")}};b.clickRight=function(){$("#seat>div>span").removeClass("seat_no");if(b.now==""){b.now=$("#16_13")}b.now.removeClass("seat_change");b.id=b.now.attr("id").split("_");b.id[0]=parseInt(b.id[0])+1;if(b.id[0]==33){b.id[0]=1}if(b.id[0]==31){b.id[1]=parseInt(b.id[1])-2}if(b.id[0]==3){b.id[1]=parseInt(b.id[1])+2}$("#"+b.id[0]+"_"+b.id[1]).addClass("seat_change");b.now=$("#"+b.id[0]+"_"+b.id[1]);b.row=b.id[1];b.cell=b.id[0];if(b.now.hasClass("seat_changed")){b.now.addClass("seat_no")}};b.clickYes=function(){console.log(b.cell);console.log(b.row);console.log(b.now);if(b.now==""){alert("è¯·é?‰æ‹©åº§ä½");return}else{if(b.now.hasClass("seat_changed")){alert("å½“å‰åº§ä½ä¸å¯é€?,è¯·é‡æ–°é?‰æ‹©åº§ä½");return}}c.go("notice2");a.cell=b.cell;a.row=b.row}}]);app.controller("notice2Ctrl",["$scope","$http","$rootScope",function(b,c,a){b.username="";b.userphone=localStorage.phone;console.log(b.cell);console.log(b.row);b.submit=function(){c.get("http://139.224.33.228:88/seat?account="+b.userphone+"&username="+b.username+"&rows="+b.row+"&cells="+b.cell).success(function(d){console.log(d);if(d.message=="é€‰åº§æˆåŠŸ"){b.data=d;localStorage.username=b.username;localStorage.cell=b.cell;localStorage.row=b.row;alert("é¢†ç¥¨æˆåŠŸ,å¯åœ¨ä¸ªäººä¸­å¿ƒæŸ¥è¯¢åº§ä½ä¿¡æ¯")}else{if(d.message=="æ‚¨å·²é¢†å–è¿‡é—¨ç¥?,ä¸?ä¸ªè´¦æˆ·åªå…è®¸é¢†å–ä¸?å¼ é—¨ç¥?"){alert("æ‚¨å·²é¢†å–è¿‡é—¨ç¥?,ä¸?ä¸ªè´¦æˆ·åªå…è®¸é¢†å–ä¸?å¼ é—¨ç¥?")}}}).error(function(){console.log("å¼‚æ­¥è¯·æ±‚å¤±è´¥")})}}]);app.controller("checkmsgCtrl",["$scope",function(a){}]);app.controller("book2Ctrl",["$scope",function(a){}]);app.controller("personCtrl",["$scope",function(a){}]);app.controller("liveplayerCtrl",["$scope","$timeout",function(a,b){a.a=49500;a.clickMe=function(){$("#img_zan").attr("src","img/zan.png");a.a+=10;$("#span_zan").html(a.a);b(function(){$("#img_zan").attr("src","img/zan1.png")},100)}}]);